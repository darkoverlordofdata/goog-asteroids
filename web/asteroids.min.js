var c;
function aa(a, b, d) {
  return a.call.apply(a.bind, arguments);
}
function ba(a, b, d) {
  if (!a) {
    throw Error();
  }
  if (2 < arguments.length) {
    var e = Array.prototype.slice.call(arguments, 2);
    return function() {
      var d = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(d, e);
      return a.apply(b, d);
    };
  }
  return function() {
    return a.apply(b, arguments);
  };
}
function h(a, b, d) {
  h = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? aa : ba;
  return h.apply(null, arguments);
}
function k(a, b) {
  function d() {
  }
  d.prototype = b.prototype;
  a.j = b.prototype;
  a.prototype = new d;
  a.prototype.constructor = a;
  a.Nb = function(a, d, g) {
    for (var v = Array(arguments.length - 2), I = 2;I < arguments.length;I++) {
      v[I - 2] = arguments[I];
    }
    return b.prototype[d].apply(a, v);
  };
}
;function l() {
}
c = l.prototype;
c.c = null;
c.next = null;
c.Ta = 0;
c.U = function() {
};
c.update = function() {
};
function m(a, b, d, e) {
  null == d && (d = null);
  null == e && (e = null);
  this.w = a;
  this.xb = b;
  this.xa = d;
  this.Ra = e;
}
k(m, l);
c = m.prototype;
c.ga = null;
c.w = null;
c.xb = null;
c.xa = null;
c.Ra = null;
c.U = function(a) {
  this.ga = n(a, this.w);
  if (null !== this.xa) {
    for (a = this.ga.head;a;) {
      this.xa(a), a = a.next;
    }
    this.ga.Pa.add(this.xa);
  }
  null !== this.Ra && this.ga.Qa.add(this.Ra);
};
c.update = function(a) {
  var b;
  for (b = this.ga.head;b;) {
    this.xb(b, a), b = b.next;
  }
};
function p() {
}
p.prototype.B = null;
p.prototype.c = null;
p.prototype.next = null;
function q(a) {
  this.Z = a;
}
q.prototype.Z = null;
function r() {
  return r.j.constructor.apply(this, arguments);
}
k(r, p);
r.className = "AnimationNode";
r.f = {Z:q};
r.prototype.Z = null;
function ca() {
  this.i = h(this.i, this);
  ca.j.constructor.call(this, r, this.i);
}
k(ca, m);
ca.prototype.i = function(a, b) {
  a.Z.Z.kb(b);
};
function t() {
  this.Ca = [];
}
t.prototype.Ca = null;
t.prototype.play = function(a) {
  return this.Ca.push(a);
};
function u() {
  return u.j.constructor.apply(this, arguments);
}
k(u, p);
u.className = "AudioNode";
u.f = {audio:t};
u.prototype.audio = null;
function da() {
  this.i = h(this.i, this);
  da.j.constructor.call(this, u, this.i);
}
k(da, m);
da.prototype.i = function(a) {
  var b, d, e;
  e = a.audio.Ca;
  for (b in e) {
    d = e[b], d = new d, d.play(0, 1);
  }
  a.audio.Ca.length = 0;
};
function ea(a) {
  this.wa = a;
}
ea.prototype.wa = 0;
function w() {
  return w.j.constructor.apply(this, arguments);
}
k(w, p);
w.Ob = "BulletAgeNode";
w.f = {ma:ea};
w.prototype.ma = null;
function fa(a) {
  this.h = a;
  this.i = h(this.i, this);
  fa.j.constructor.call(this, w, this.i);
}
k(fa, m);
fa.prototype.h = null;
fa.prototype.i = function(a, b) {
  var d;
  d = a.ma;
  d.wa -= b;
  0 >= d.wa && this.h.g.S(a.B);
};
function ga(a) {
  this.ba = a;
}
ga.prototype.ba = null;
function x(a, b) {
  this.x = null != a ? a : 0;
  this.y = null != b ? b : 0;
}
x.prototype.x = 0;
x.prototype.y = 0;
function ha(a, b) {
  var d, e;
  d = a.x - b.x;
  e = a.y - b.y;
  return Math.sqrt(d * d + e * e);
}
function ia(a, b) {
  var d, e;
  d = a.x - b.x;
  e = a.y - b.y;
  return Math.sqrt(d * d + e * e);
}
;function y(a, b, d) {
  this.rotation = d;
  this.position = new x(a, b);
}
y.prototype.position = null;
y.prototype.rotation = 0;
function z(a) {
  this.o = a;
}
z.prototype.o = 0;
function A() {
  return A.j.constructor.apply(this, arguments);
}
k(A, p);
A.className = "SpaceshipCollisionNode";
A.f = {Aa:ga, position:y, v:z, audio:t};
A.prototype.Aa = null;
A.prototype.position = null;
A.prototype.v = null;
A.prototype.audio = null;
function ja(a) {
  this.ba = a;
}
ja.prototype.ba = null;
function B() {
  return B.j.constructor.apply(this, arguments);
}
k(B, p);
B.className = "AsteroidCollisionNode";
B.f = {lb:ja, position:y, v:z, audio:t};
B.prototype.lb = null;
B.prototype.position = null;
B.prototype.v = null;
B.prototype.audio = null;
function C() {
  return C.j.constructor.apply(this, arguments);
}
k(C, p);
C.className = "BulletCollisionNode";
C.f = {ma:ea, position:y, v:z};
C.prototype.ma = null;
C.prototype.position = null;
C.prototype.v = null;
function D() {
}
D.className = "GameState";
D.prototype.R = 3;
D.prototype.level = 0;
D.prototype.Ja = 0;
D.prototype.Sa = !1;
function E() {
  return E.j.constructor.apply(this, arguments);
}
k(E, p);
E.className = "GameNode";
E.f = {state:D};
E.prototype.state = null;
function F(a) {
  this.na = a;
}
F.prototype.na = 0;
function G(a) {
  this.a = a;
}
G.prototype.a = 0;
function ka(a, b, d, e) {
  this.wb = d;
  this.nb = e;
  this.$a = !1;
  this.X = null;
  this.ia = 0;
  this.X = new x(a, b);
}
c = ka.prototype;
c.$a = !1;
c.ia = 0;
c.X = null;
c.wb = 0;
c.nb = 0;
function la(a) {
  this.Cb = a;
}
la.prototype.Cb = 0;
function ma(a) {
  this.view = a;
}
ma.prototype.view = null;
function H(a, b, d, e) {
  this.jb = d;
  this.pa = e;
  this.l = new x(a, b);
}
H.prototype.l = null;
H.prototype.jb = 0;
H.prototype.pa = 0;
function na(a, b, d, e, f) {
  this.left = a;
  this.right = b;
  this.ib = d;
  this.Fa = e;
  this.rotationRate = f;
}
c = na.prototype;
c.left = 0;
c.right = 0;
c.ib = 0;
c.Fa = 0;
c.rotationRate = 0;
function J(a) {
  this.Db = a;
  this.Za = h(this.Za, this);
  this.Db.click.add(this.Za);
}
J.prototype.Db = null;
J.prototype.Ba = !1;
J.prototype.Za = function() {
  this.Ba = !0;
};
function oa(a, b) {
  this.a = a;
  this.o = b;
  this.ta = [];
}
c = oa.prototype;
c.ta = null;
c.x = 0;
c.y = 0;
c.width = 0;
c.height = 0;
c.rotation = 0;
c.a = null;
c.o = 0;
c.Y = null;
c.count = 0;
c.first = !0;
c.kb = function(a) {
  var b, d, e, f;
  if (this.first) {
    for (this.first = !1, d = 0;8 > d;++d) {
      b = new pa(this.a, this.o), this.ta.push(b);
    }
  }
  f = this.ta;
  d = 0;
  for (e = f.length;d < e;d++) {
    b = f[d], b.x += b.l.x * a, b.y += b.l.y * a;
  }
  return this.u();
};
c.u = function() {
  var a, b, d, e, f;
  e = this.ta;
  f = [];
  b = 0;
  for (d = e.length;b < d;b++) {
    a = e[b], f.push(a.u(this.x, this.y));
  }
  return f;
};
function pa(a, b) {
  var d, e;
  this.a = a;
  d = 2 * Math.random() * Math.PI;
  e = Math.random() * b;
  this.x = Math.cos(d) * e;
  this.y = Math.sin(d) * e;
  e = 10 * Math.random() + 10;
  this.l = new x(Math.cos(d) * e, Math.sin(d) * e);
}
c = pa.prototype;
c.l = null;
c.a = null;
c.ja = 0;
c.ka = 0;
c.x = 0;
c.y = 0;
c.u = function(a, b) {
  var d;
  d = this.a;
  d.save();
  d.beginPath();
  d.translate(a, b);
  d.rotate(this.rotation);
  d.fillStyle = "#FFFFFF";
  d.arc(this.x, this.y, 2, 0, 2 * Math.PI, !1);
  d.fill();
  d.restore();
};
function qa(a, b) {
  var d, e, f;
  this.a = a;
  this.height = this.width = this.o = b;
  this.Y = [];
  for (d = 0;d < 2 * Math.PI;) {
    e = (.75 + .25 * Math.random()) * this.o, f = Math.cos(d) * e, e *= Math.sin(d), this.Y.push({x:f, y:e}), d += .5 * Math.random();
  }
}
c = qa.prototype;
c.x = 0;
c.y = 0;
c.width = 0;
c.height = 0;
c.rotation = 0;
c.a = null;
c.o = 0;
c.Y = null;
c.count = 0;
c.u = function() {
  var a, b;
  a = this.a;
  a.save();
  a.beginPath();
  a.translate(this.x, this.y);
  a.rotate(this.rotation);
  a.fillStyle = "#FFFFFF";
  a.moveTo(this.o, 0);
  for (b = 0;b < this.Y.length;) {
    a.lineTo(this.Y[b].x, this.Y[b].y), ++b;
  }
  a.lineTo(this.o, 0);
  a.fill();
  a.restore();
};
function ra(a) {
  this.a = a;
}
c = ra.prototype;
c.x = 0;
c.y = 0;
c.width = 4;
c.height = 4;
c.rotation = 0;
c.a = null;
c.u = function() {
  var a;
  a = this.a;
  a.save();
  a.beginPath();
  a.rotate(this.rotation);
  a.fillStyle = "#FFFFFF";
  a.arc(this.x, this.y, 2, 0, 2 * Math.PI, !1);
  a.fill();
  a.restore();
};
function sa(a) {
  this.a = a;
  this.Ya = h(this.Ya, this);
  this.Xa = h(this.Xa, this);
  this.u = h(this.u, this);
  this.qb = this.Jb;
  this.pb = this.Ib;
}
c = sa.prototype;
c.x = 0;
c.y = 0;
c.width = 4;
c.height = 4;
c.rotation = 0;
c.a = null;
c.Bb = 0;
c.R = 3;
c.qb = null;
c.pb = null;
c.u = function() {
  this.qb();
  this.pb();
};
c.Xa = function(a) {
  return this.R = a;
};
c.Ya = function(a) {
  return this.Bb = a;
};
c.Ib = function() {
  var a;
  this.a.save();
  this.a.beginPath();
  this.a.font = "bold 18px Helvetica";
  this.a.fillStyle = "#FFFFFF";
  this.a.textAlign = "center";
  a = "LIVES: " + this.R;
  this.a.fillText(a, this.a.measureText(a).width, 20);
  this.a.fill();
  this.a.restore();
};
c.Jb = function() {
  var a;
  this.a.save();
  this.a.beginPath();
  this.a.font = "bold 18px Helvetica";
  this.a.fillStyle = "#FFFFFF";
  this.a.textAlign = "center";
  a = "SCORE: " + this.Bb;
  this.a.fillText(a, window.window.innerWidth * window.devicePixelRatio - this.a.measureText(a).width, 20);
  this.a.fill();
  this.a.restore();
};
function ta(a) {
  this.a = a;
}
c = ta.prototype;
c.x = 0;
c.y = 0;
c.width = 20;
c.height = 20;
c.rotation = 0;
c.a = null;
c.eb = null;
c.fb = null;
c.zb = null;
c.Ab = null;
c.ja = 0;
c.la = 0;
c.ka = 0;
c.la = 0;
c.first = !0;
c.kb = function(a) {
  this.first && (this.first = !1, this.eb = new x(10 * Math.random() - 5, 10 * Math.random() + 10), this.fb = new x(10 * Math.random() - 5, -(10 * Math.random() + 10)), this.zb = 300 * Math.random() - 150, this.Ab = 300 * Math.random() - 150, this.ja = this.hb = this.x, this.ka = this.la = this.y, this.Ua = this.Va = this.rotation);
  this.ja += this.eb.x * a;
  this.ka += this.eb.y * a;
  this.Ua += this.zb * a;
  this.hb += this.fb.x * a;
  this.la += this.fb.y * a;
  this.Va += this.Ab * a;
  return this.u();
};
c.u = function() {
  var a;
  a = this.a;
  a.save();
  a.beginPath();
  a.translate(this.x + this.ja, this.y + this.ka);
  a.rotate(this.Ua);
  a.fillStyle = "#FFFFFF";
  a.moveTo(10, 0);
  a.lineTo(-7, 7);
  a.lineTo(-4, 0);
  a.lineTo(10, 0);
  a.fill();
  a.restore();
  a.save();
  a.beginPath();
  a.translate(this.x + this.hb, this.y + this.la);
  a.rotate(this.Va);
  a.fillStyle = "#FFFFFF";
  a.moveTo(10, 0);
  a.lineTo(-7, 7);
  a.lineTo(-4, 0);
  a.lineTo(10, 0);
  a.fill();
  a.restore();
};
function ua(a) {
  this.a = a;
}
c = ua.prototype;
c.x = 0;
c.y = 0;
c.width = 20;
c.height = 20;
c.rotation = 0;
c.a = null;
c.u = function() {
  var a;
  a = this.a;
  a.save();
  a.beginPath();
  a.translate(this.x, this.y);
  a.rotate(this.rotation);
  a.fillStyle = "#FFFFFF";
  a.moveTo(10, 0);
  a.lineTo(-7, 7);
  a.lineTo(-4, 0);
  a.lineTo(-7, -7);
  a.lineTo(10, 0);
  a.fill();
  a.restore();
};
function va(a) {
  this.h = a;
  this.update = h(this.update, this);
}
k(va, l);
c = va.prototype;
c.h = null;
c.da = null;
c.T = null;
c.D = null;
c.$ = null;
c.U = function(a) {
  this.da = n(a, E);
  this.T = n(a, A);
  this.D = n(a, B);
  this.$ = n(a, C);
};
c.update = function() {
  var a, b;
  for (b = this.$.head;b;) {
    for (a = this.D.head;a;) {
      if (ia(a.position.position, b.position.position) <= a.v.o) {
        this.h.g.S(b.B);
        10 < a.v.o && (wa(this.h, a.v.o - 10, a.position.position.x + 10 * Math.random() - 5, a.position.position.y + 10 * Math.random() - 5), wa(this.h, a.v.o - 10, a.position.position.x + 10 * Math.random() - 5, a.position.position.y + 10 * Math.random() - 5));
        xa(a.lb.ba, "destroyed");
        this.da.head && this.da.head.state.Ja++;
        break;
      }
      a = a.next;
    }
    b = b.next;
  }
  for (b = this.T.head;b;) {
    for (a = this.D.head;a;) {
      if (ia(a.position.position, b.position.position) <= a.v.o + b.v.o) {
        xa(b.Aa.ba, "destroyed");
        this.da.head && this.da.head.state.R++;
        break;
      }
      a = a.next;
    }
    b = b.next;
  }
};
function K() {
  return K.j.constructor.apply(this, arguments);
}
k(K, p);
K.className = "DeathThroesNode";
K.f = {qa:F};
K.prototype.qa = null;
function ya(a) {
  this.h = a;
  this.i = h(this.i, this);
  ya.j.constructor.call(this, K, this.i);
}
k(ya, m);
ya.prototype.h = null;
ya.prototype.i = function(a, b) {
  a.qa.na -= b;
  0 >= a.qa.na && this.h.g.S(a.B);
};
function L() {
  return L.j.constructor.apply(this, arguments);
}
k(L, p);
L.className = "SpaceshipNode";
L.f = {Aa:ga, position:y};
L.prototype.Aa = null;
L.prototype.position = null;
function za(a, b) {
  this.h = a;
  this.m = b;
  this.update = h(this.update, this);
}
k(za, l);
c = za.prototype;
c.m = null;
c.h = null;
c.ca = null;
c.T = null;
c.D = null;
c.$ = null;
c.U = function(a) {
  this.ca = n(a, E);
  this.T = n(a, L);
  this.D = n(a, B);
  this.$ = n(a, C);
};
c.update = function() {
  var a, b, d, e;
  if ((b = this.ca.head) && b.state.Sa) {
    if (null === this.T.head) {
      if (0 < b.state.R) {
        e = new x(.5 * this.m.width, .5 * this.m.height);
        d = !0;
        for (a = this.D.head;a;) {
          if (ha(a.position.position, e) <= a.v.o + 50) {
            d = !1;
            break;
          }
          a = a.next;
        }
        if (d) {
          a = this.h;
          var f;
          f = new M;
          e = new Aa(f);
          N(N(N(N(N(N(Ba(e, "playing").add(H), new H(0, 0, 0, 15)).add(na), new na(37, 39, 38, 100, 3)).add(ka), new ka(8, 0, .3, 2)).add(la), new la(90)).add(z), new z(9)).add(G), new G(new ua(a.a)));
          d = new ta(a.a);
          N(N(N(Ba(e, "destroyed").add(F), new F(5)).add(G), new G(d)).add(q), new q(d));
          f.add(new ga(e)).add(new y(300, 225, 0)).add(new t);
          xa(e, "playing");
          Ca(a.g, f);
        }
      } else {
        b.state.Sa = !1, Da(this.h);
      }
    }
    if (null === this.D.head && null === this.$.head && null !== this.T.head) {
      for (a = this.T.head, b.state.level++, b = 2 + b.state.level, d = 0;d < b;) {
        for (;e = new x(Math.random() * this.m.width, Math.random() * this.m.height), 80 >= ha(e, a.position.position);) {
        }
        wa(this.h, 30, e.x, e.y);
        ++d;
      }
    }
  }
};
function O() {
  return O.j.constructor.apply(this, arguments);
}
k(O, p);
O.className = "GunControlNode";
O.f = {audio:t, control:la, tb:ka, position:y};
O.prototype.control = null;
O.prototype.tb = null;
O.prototype.position = null;
O.prototype.audio = null;
function P(a, b) {
  this.C = a;
  this.h = b;
  this.i = h(this.i, this);
  P.j.constructor.call(this, O, this.i);
}
k(P, m);
P.prototype.C = null;
P.prototype.h = null;
P.prototype.i = function(a, b) {
  var d, e, f;
  d = a.control;
  f = a.position;
  e = a.tb;
  e.$a = this.C.W(d.Cb);
  e.ia += b;
  if (e.$a && e.ia >= e.wb) {
    d = this.h;
    var g, v, I;
    g = Math.cos(f.rotation);
    v = Math.sin(f.rotation);
    I = g * e.X.x - v * e.X.y + f.position.x;
    f = v * e.X.x + g * e.X.y + f.position.y;
    f = (new M).add(new ea(e.nb)).add(new y(I, f, 0)).add(new z(0)).add(new H(150 * g, 150 * v, 0, 0)).add(new G(new ra(d.a)));
    Ca(d.g, f);
    e.ia = 0;
  }
};
function Q() {
  return Q.j.constructor.apply(this, arguments);
}
k(Q, p);
Q.className = "HudNode";
Q.f = {state:D, Ka:ma};
Q.prototype.state = null;
Q.prototype.Ka = null;
function Ea() {
  this.i = h(this.i, this);
  Ea.j.constructor.call(this, Q, this.i);
}
k(Ea, m);
Ea.prototype.i = function(a) {
  a.Ka.view.Xa(a.state.R);
  a.Ka.view.Ya(a.state.Ja);
};
function R() {
  return R.j.constructor.apply(this, arguments);
}
k(R, p);
R.className = "MotionControlNode";
R.f = {control:na, position:y, fa:H};
R.prototype.control = null;
R.prototype.position = null;
R.prototype.fa = null;
function Fa(a) {
  this.C = a;
  this.i = h(this.i, this);
  Fa.j.constructor.call(this, R, this.i);
}
k(Fa, m);
Fa.prototype.C = null;
Fa.prototype.i = function(a, b) {
  var d, e, f, g, v;
  d = a.control;
  g = a.position;
  f = a.fa;
  e = this.C.W(d.left);
  v = this.C.W(d.right);
  e && (g.rotation -= d.rotationRate * b);
  v && (g.rotation += d.rotationRate * b);
  this.C.W(d.ib) && (f.l.x += Math.cos(g.rotation) * d.Fa * b, f.l.y += Math.sin(g.rotation) * d.Fa * b);
};
function S() {
  return S.j.constructor.apply(this, arguments);
}
k(S, p);
S.className = "MovementNode";
S.f = {position:y, fa:H};
S.prototype.position = null;
S.prototype.fa = null;
function Ga(a) {
  this.m = a;
  this.i = h(this.i, this);
  Ga.j.constructor.call(this, S, this.i);
}
k(Ga, m);
Ga.prototype.m = null;
Ga.prototype.i = function(a, b) {
  var d, e, f;
  e = a.position;
  d = a.fa;
  e.position.x += d.l.x * b;
  e.position.y += d.l.y * b;
  0 > e.position.x && (e.position.x += this.m.width);
  e.position.x > this.m.width && (e.position.x -= this.m.width);
  0 > e.position.y && (e.position.y += this.m.height);
  e.position.y > this.m.height && (e.position.y -= this.m.height);
  e.rotation += d.jb * b;
  0 < d.pa && (f = Math.abs(Math.cos(e.rotation) * d.pa * b), e = Math.abs(Math.sin(e.rotation) * d.pa * b), d.l.x = d.l.x > f ? d.l.x - f : d.l.x < -f ? d.l.x + f : 0, d.l.y = d.l.y > e ? d.l.y - e : d.l.y < -e ? d.l.y + e : 0);
};
function T() {
  return T.j.constructor.apply(this, arguments);
}
k(T, p);
T.className = "RenderNode";
T.f = {position:y, display:G};
T.prototype.position = null;
T.prototype.display = null;
function U(a) {
  this.a = a;
  this.update = h(this.update, this);
}
k(U, l);
U.prototype.a = null;
U.prototype.s = null;
U.prototype.U = function(a) {
  this.s = n(a, T);
  for (a = this.s.head;a;) {
    a = a.next;
  }
};
U.prototype.update = function() {
  var a, b, d;
  this.a.save();
  this.a.translate(0, 0);
  this.a.rotate(0);
  this.a.clearRect(0, 0, this.a.canvas.width, this.a.canvas.height);
  for (b = this.s.head;b;) {
    a = b.display, a = a.a, d = b.position, a.x = d.position.x, a.y = d.position.y, a.rotation = d.rotation, a.u(), b = b.next;
  }
  this.a.restore();
};
function V() {
  return V.j.constructor.apply(this, arguments);
}
k(V, p);
V.className = "WaitForStartNode";
V.f = {gb:J};
V.prototype.gb = null;
function Ha(a) {
  this.h = a;
  this.update = h(this.update, this);
}
k(Ha, l);
c = Ha.prototype;
c.g = null;
c.h = null;
c.ca = null;
c.Eb = null;
c.D = null;
c.U = function(a) {
  this.g = a;
  this.Eb = n(a, V);
  this.ca = n(a, E);
  this.D = n(a, B);
};
c.update = function() {
  var a, b, d;
  d = this.Eb.head;
  b = this.ca.head;
  if (d && d.gb.Ba && b) {
    for (a = this.D.head;a;) {
      this.h.g.S(a.B), a = a.next;
    }
    a = b.state;
    a.R = 3;
    a.level = 0;
    a.Ja = 0;
    a.Sa = !0;
    d.gb.Ba = !1;
    this.g.S(d.B);
  }
};
function Ia() {
}
Ia.prototype.c = null;
Ia.prototype.next = null;
Ia.prototype.listener = null;
Ia.prototype.ya = !1;
function Ja() {
}
c = Ja.prototype;
c.b = null;
c.A = null;
c.get = function() {
  var a;
  return null !== this.b ? (a = this.b, this.b = this.b.c, a.c = null, a) : new Ia;
};
c.sa = function(a) {
  a.listener = null;
  a.ya = !1;
  a.next = null;
  a.c = this.b;
  this.b = a;
};
c.cache = function(a) {
  a.listener = null;
  a.c = this.A;
  this.A = a;
};
c.Wa = function() {
  for (var a;null !== this.A;) {
    a = this.A, this.A = a.c, a.next = null, a.c = this.b, this.b = a;
  }
};
function Ka() {
  this.s = [];
  this.keys = [];
  this.ea = new Ja;
}
c = Ka.prototype;
c.head = null;
c.b = null;
c.keys = null;
c.s = null;
c.ea = null;
c.H = null;
c.L = null;
c.V = !1;
function La(a) {
  a.V = !1;
  a.H && (a.head ? (a.b.next = a.H, a.H.c = a.b) : a.head = a.H, a.b = a.L, a.H = null, a.L = null);
  a.ea.Wa();
}
c.add = function(a) {
  var b;
  -1 === this.keys.indexOf(a) && (b = this.ea.get(), b.listener = a, this.s.push(b), this.keys.push(a), this.V ? null === this.H ? this.H = this.L = b : (this.L.next = b, b.c = this.L, this.L = b) : null === this.head ? this.head = this.b = b : (this.b.next = b, b.c = this.b, this.b = b));
};
c.remove = function(a) {
  var b;
  a = this.keys.indexOf(a);
  if (b = this.s[a]) {
    this.head === b && (this.head = this.head.next), this.b === b && (this.b = this.b.c), this.H === b && (this.H = this.H.next), this.L === b && (this.L = this.L.c), b.c && (b.c.next = b.next), b.next && (b.next.c = b.c), this.s.splice(a, 1), this.keys.splice(a, 1), this.V ? this.ea.cache(b) : this.ea.sa(b);
  }
};
function Ma() {
  return Ma.j.constructor.apply(this, arguments);
}
k(Ma, Ka);
Ma.prototype.K = function() {
  var a;
  this.V = !0;
  for (a = this.head;null !== a;) {
    a.listener(), a.ya && this.remove(a.listener), a = a.next;
  }
  return La(this);
};
function Na(a) {
  this.a = a;
  this.click = new Ma;
  this.rb = this.Gb;
  this.ub = this.Hb;
  this.ob = this.Fb;
  this.a.canvas.addEventListener("click", function(a) {
    return function() {
      return a.click.K();
    };
  }(this));
}
c = Na.prototype;
c.x = 0;
c.y = 0;
c.width = 4;
c.height = 4;
c.rotation = 0;
c.a = null;
c.rb = null;
c.ob = null;
c.ub = null;
c.click = null;
c.Gb = function() {
  this.a.save();
  this.a.beginPath();
  this.a.font = "bold 32px Helvetica";
  this.a.fillStyle = "#FFFFFF";
  this.a.fillText("ASTEROIDS", Math.floor((window.innerWidth * window.devicePixelRatio - this.a.measureText("ASTEROIDS").width) / 2), 175);
  this.a.fill();
  this.a.restore();
};
c.Fb = function() {
  this.a.save();
  this.a.beginPath();
  this.a.font = "bold 18px Helvetica";
  this.a.fillStyle = "#FFFFFF";
  this.a.fillText("CLICK TO START", Math.floor((window.innerWidth * window.devicePixelRatio - this.a.measureText("CLICK TO START").width) / 2), 225);
  this.a.fill();
  this.a.restore();
};
c.Hb = function() {
  this.a.save();
  this.a.beginPath();
  this.a.font = "bold 14px Helvetica";
  this.a.fillStyle = "#FFFFFF";
  this.a.fillText("CTRL-Z to Fire  ~  Arrow Keys to Move", 10, window.innerHeight * window.devicePixelRatio - 20);
  this.a.fill();
  this.a.restore();
};
c.u = function() {
  this.rb();
  this.ob();
  this.ub();
};
function W() {
  return W.j.constructor.apply(this, arguments);
}
k(W, Ka);
W.prototype.K = function(a, b) {
  var d;
  this.V = !0;
  for (d = this.head;d;) {
    d.listener(a, b), d.ya && this.remove(d.listener), d = d.next;
  }
  return La(this);
};
function X() {
}
;function Y(a) {
  var b;
  return null != (b = a.className) ? b : a.name;
}
;function M(a) {
  null == a && (a = "");
  this.I = new W;
  this.J = new W;
  this.Oa = new W;
  this.f = new X;
  "" !== a ? (null == Oa[a] && (Oa[a] = 0), this.name = a + ++Oa[a]) : this.name = "_entity" + ++Pa;
}
var Pa, Oa = {};
Pa = 0;
c = M.prototype;
c.name = "";
c.I = null;
c.J = null;
c.Oa = null;
c.c = null;
c.next = null;
c.f = null;
c.add = function(a, b) {
  null == b && (b = a.constructor);
  Y(b) in this.f && this.remove(b);
  this.f[Y(b)] = a;
  this.I.K(this, b);
  return this;
};
c.remove = function(a) {
  var b;
  b = null != Y(a) ? Y(a) : a;
  return (a = this.f[b]) ? (delete this.f[b], this.J.K(this, b), a) : null;
};
c.get = function(a) {
  return this.f[Y(a)];
};
c.getAll = function() {
  var a, b, d, e, f;
  b = [];
  f = this.f;
  d = 0;
  for (e = f.length;d < e;d++) {
    a = f[d], b.push(a);
  }
  return b;
};
c.has = function(a) {
  return Y(a) in this.f;
};
function Qa(a) {
  this.La = a;
}
Qa.prototype.La = null;
Qa.prototype.sb = function() {
  return this.La;
};
Qa.prototype.Ia = function() {
  return this.La;
};
function Ra(a) {
  this.O = a;
}
Ra.prototype.O = null;
Ra.prototype.sb = function() {
  return new this.O;
};
Ra.prototype.Ia = function() {
  return this.O;
};
function Sa(a, b) {
  this.oa = a;
  this.O = b;
  this.oa.F[this.O] = new Ra(b);
}
Sa.prototype.O = null;
Sa.prototype.oa = null;
function N(a, b) {
  a.oa.F[a.O] = new Qa(b);
  return a;
}
Sa.prototype.add = function(a) {
  return this.oa.add(a);
};
function Ta() {
  this.F = new X;
}
Ta.prototype.F = null;
Ta.prototype.add = function(a) {
  return new Sa(this, Y(a));
};
Ta.prototype.get = function(a) {
  return this.F[a];
};
Ta.prototype.has = function(a) {
  return null !== this.F[a];
};
function Aa(a) {
  this.B = a;
  this.G = new X;
}
Aa.prototype.G = null;
Aa.prototype.aa = null;
Aa.prototype.B = null;
function Ba(a, b) {
  var d;
  d = new Ta;
  return a.G[b] = d;
}
function xa(a, b) {
  var d, e, f, g;
  d = a.G[b];
  if (!d) {
    throw Error("Entity state " + b + " doesn't exist");
  }
  if (d !== a.aa) {
    if (a.aa) {
      f = new X;
      for (g in d.F) {
        f[g] = d.F[g];
      }
      for (g in a.aa.F) {
        (e = f[g]) && e.Ia() === a.aa.F[g].Ia() ? delete f[g] : a.B.remove(g);
      }
    } else {
      f = d.F;
    }
    for (g in f) {
      a.B.add(f[g].sb());
    }
    a.aa = d;
  }
}
;function Ua(a, b, d) {
  this.g = a;
  this.a = b;
  this.Mb = d;
}
Ua.prototype.g = null;
Ua.prototype.Ea = null;
Ua.prototype.a = null;
function Da(a) {
  var b;
  a.Ea || (b = new Na(a.a), a.Ea = (new M("wait")).add(new J(b)).add(new G(b)).add(new y(0, 0, 0)));
  a.Ea.get(J).Ba = !1;
  Ca(a.g, a.Ea);
}
function wa(a, b, d, e) {
  var f, g;
  f = new M;
  g = new Aa(f);
  N(N(N(Ba(g, "alive").add(H), new H(4 * (Math.random() - .5) * (50 - b), 4 * (Math.random() - .5) * (50 - b), 2 * Math.random() - 1, 0)).add(z), new z(b)).add(G), new G(new qa(a.a, b)));
  b = new oa(a.a, b);
  N(N(N(Ba(g, "destroyed").add(F), new F(3)).add(G), new G(b)).add(q), new q(b));
  f.add(new ja(g)).add(new y(d, e, 0)).add(new t);
  xa(g, "alive");
  Ca(a.g, f);
}
;function Va() {
}
Va.prototype.width = 0;
Va.prototype.height = 0;
function Wa(a) {
  this.Ha = a;
  this.vb = h(this.vb, this);
  this.W = h(this.W, this);
  this.Na = h(this.Na, this);
  this.Ma = h(this.Ma, this);
  this.G = {};
  this.Ha.addEventListener("keydown", this.Ma);
  this.Ha.addEventListener("keyup", this.Na);
}
c = Wa.prototype;
c.G = null;
c.Ha = null;
c.Ma = function(a) {
  this.G[a.keyCode] = !0;
};
c.Na = function(a) {
  this.G[a.keyCode] && (this.G[a.keyCode] = !1);
};
c.W = function(a) {
  return this.G[a];
};
c.vb = function(a) {
  return !this.G[a];
};
function Xa() {
}
Xa.prototype.head = null;
Xa.prototype.b = null;
Xa.prototype.add = function(a) {
  this.head ? (this.b.next = a, a.c = this.b, a.next = null, this.b = a) : (this.head = this.b = a, a.next = a.c = null);
};
Xa.prototype.remove = function(a) {
  this.head === a && (this.head = this.head.next);
  this.b === a && (this.b = this.b.c);
  a.c && (a.c.next = a.next);
  a.next && (a.next.c = a.c);
};
function Ya() {
}
c = Ya.prototype;
c.head = null;
c.b = null;
c.add = function(a) {
  var b;
  if (this.head) {
    for (b = this.b;b && !(b.Ta <= a.Ta);) {
      b = b.c;
    }
    b === this.b ? (this.b.next = a, a.c = this.b, a.next = null, this.b = a) : b ? (a.next = b.next, a.c = b, b.next.c = a, b.next = a) : (a.next = this.head, a.c = null, this.head = this.head.c = a);
  } else {
    this.head = this.b = a, a.next = a.c = null;
  }
};
c.remove = function(a) {
  this.head === a && (this.head = this.head.next);
  this.b === a && (this.b = this.b.c);
  a.c && (a.c.next = a.next);
  a.next && (a.next.c = a.c);
};
c.get = function(a) {
  var b;
  for (b = this.head;b;) {
    if (b.constructor === a) {
      return b;
    }
    b = b.next;
  }
  return null;
};
function Za() {
  return Za.j.constructor.apply(this, arguments);
}
k(Za, Ka);
Za.prototype.K = function(a) {
  var b;
  this.V = !0;
  for (b = this.head;null !== b;) {
    b.listener(a), b.ya && this.remove(b.listener), b = b.next;
  }
  return La(this);
};
function $a() {
  this.Pa = new Za;
  this.Qa = new Za;
}
c = $a.prototype;
c.head = null;
c.b = null;
c.Pa = null;
c.Qa = null;
c.add = function(a) {
  this.head ? (this.b.next = a, a.c = this.b, a.next = null, this.b = a) : (this.head = this.b = a, a.next = a.c = null);
  this.Pa.K(a);
};
c.remove = function(a) {
  this.head === a && (this.head = this.head.next);
  this.b === a && (this.b = this.b.c);
  a.c && (a.c.next = a.next);
  a.next && (a.next.c = a.c);
  this.Qa.K(a);
};
function ab(a, b) {
  this.w = a;
  this.f = b;
}
c = ab.prototype;
c.b = null;
c.w = null;
c.A = null;
c.f = null;
c.get = function() {
  var a;
  this.b ? (a = this.b, this.b = this.b.c, a.c = null) : a = new this.w;
  return a;
};
c.sa = function(a) {
  for (var b in this.f) {
    a[b] = null;
  }
  a.B = null;
  a.next = null;
  a.c = this.b;
  this.b = a;
};
c.cache = function(a) {
  a.c = this.A;
  this.A = a;
};
c.Wa = function() {
  for (var a;this.A;) {
    a = this.A, this.A = a.c, this.sa(a);
  }
};
function bb(a, b) {
  this.w = a;
  this.g = b;
  this.za = h(this.za, this);
  var d, e, f;
  this.s = new $a;
  this.entities = new X;
  this.f = new X;
  this.ha = new ab(this.w, this.w.f);
  f = this.w.f;
  for (d in f) {
    e = f[d], this.f[Y(e)] = e;
  }
}
c = bb.prototype;
c.s = null;
c.entities = null;
c.w = null;
c.f = null;
c.ha = null;
c.g = null;
c.S = function(a) {
  cb(this, a);
};
function db(a, b) {
  var d, e, f, g;
  if (null == a.entities[b.name]) {
    f = a.w.f;
    for (e in f) {
      if (d = f[e], !b.has(d)) {
        return;
      }
    }
    f = a.ha.get();
    f.B = b;
    g = a.w.f;
    for (e in g) {
      d = g[e], f[e] = b.get(d);
    }
    a.entities[b.name] = f;
    a.s.add(f);
  }
}
function cb(a, b) {
  var d;
  b.name in a.entities && (d = a.entities[b.name], delete a.entities[b.name], a.s.remove(d), a.g.updating ? (a.ha.cache(d), a.g.Da.add(a.za)) : a.ha.sa(d));
}
c.za = function() {
  this.g.Da.remove(this.za);
  this.ha.Wa();
};
function eb() {
  this.update = h(this.update, this);
  this.J = h(this.J, this);
  this.I = h(this.I, this);
  this.va = h(this.va, this);
  this.ua = new Xa;
  this.P = new X;
  this.bb = new Ya;
  this.N = new X;
  this.Da = new Ma;
}
c = eb.prototype;
c.P = null;
c.ua = null;
c.bb = null;
c.N = null;
c.updating = !1;
c.Da = null;
c.Kb = bb;
function Ca(a, b) {
  var d, e, f;
  if (a.P[b.name]) {
    throw "The entity name " + b.name + " is already in use by another entity.";
  }
  a.ua.add(b);
  a.P[b.name] = b;
  b.I.add(a.I);
  b.J.add(a.J);
  b.Oa.add(a.va);
  f = a.N;
  for (d in f) {
    e = f[d], db(e, b);
  }
}
c.S = function(a) {
  var b, d, e;
  a.I.remove(this.I);
  a.J.remove(this.J);
  a.Oa.remove(this.va);
  e = this.N;
  for (b in e) {
    d = e[b], d.S(a);
  }
  delete this.P[a.name];
  this.ua.remove(a);
};
c.va = function(a, b) {
  this.P[b] === a && (delete this.P[b], this.P[a.name] = a);
};
c.I = function(a) {
  var b, d, e;
  e = this.N;
  for (b in e) {
    d = e[b], db(d, a);
  }
};
c.J = function(a, b) {
  var d, e, f;
  f = this.N;
  for (d in f) {
    e = f[d], (null != Y(b) ? Y(b) : b) in e.f && cb(e, a);
  }
};
function n(a, b) {
  var d, e;
  if (Y(b) in a.N) {
    return a.N[Y(b)].s;
  }
  e = new a.Kb(b, a);
  a.N[Y(b)] = e;
  for (d = a.ua.head;d;) {
    db(e, d), d = d.next;
  }
  return e.s;
}
function Z(a, b, d) {
  b.Ta = d;
  b.U(a);
  a.bb.add(b);
}
c.update = function(a) {
  var b;
  this.updating = !0;
  for (b = this.bb.head;b;) {
    b.update(a), b = b.next;
  }
  this.updating = !1;
  this.Da.K();
};
function fb(a, b) {
  this.M = a;
  this.ra = h(this.ra, this);
  fb.j.constructor.apply(this, arguments);
  null != this.M && "function" === typeof this.M.begin && "function" === typeof this.M.end && (this.ab = !0, this.mb = this.M.begin.bind(this.M), this.end = this.M.end.bind(this.M));
}
k(fb, Za);
c = fb.prototype;
c.ab = !1;
c.mb = null;
c.end = null;
c.M = null;
c.yb = 0;
c.request = null;
c.start = function() {
  this.request = requestAnimationFrame(this.ra);
};
c.stop = function() {
  cancelRequestAnimationFrame(this.request);
};
c.ra = function(a) {
  var b;
  null == a && (a = Date.now());
  this.ab && this.mb();
  b = this.yb || a;
  this.yb = a;
  this.K(.001 * (a - b));
  requestAnimationFrame(this.ra);
  this.ab && this.end();
};
function gb(a, b, d) {
  this.Ga = a;
  this.g = new eb;
  this.h = new Ua(this.g, this.Ga, this.Mb);
  this.C = new Wa(window);
  this.m = new Va;
  this.m.height = d;
  this.m.width = b;
  Z(this.g, new Ha(this.h), 1);
  Z(this.g, new za(this.h, this.m), 1);
  Z(this.g, new Fa(this.C), 2);
  Z(this.g, new P(this.C, this.h), 2);
  Z(this.g, new fa(this.h), 2);
  Z(this.g, new ya(this.h), 2);
  Z(this.g, new Ga(this.m), 3);
  Z(this.g, new va(this.h), 4);
  Z(this.g, new ca, 6);
  Z(this.g, new Ea, 6);
  Z(this.g, new U(this.Ga), 7);
  Z(this.g, new da, 7);
  Da(this.h);
  a = this.h;
  b = new sa(a.a);
  b = (new M("game")).add(new D).add(new ma(b)).add(new G(b)).add(new y(0, 0, 0));
  Ca(a.g, b);
}
c = gb.prototype;
c.Ga = null;
c.g = null;
c.cb = null;
c.h = null;
c.C = null;
c.m = null;
c.start = function() {
  var a, b;
  navigator.Lb ? a = null : (b = Math.floor(this.m.width / 2) - 40, a = new window.Stats, a.setMode(0), a.domElement.style.position = "absolute", a.domElement.style.left = b + "px", a.domElement.style.top = "0px", document.body.appendChild(a.domElement));
  this.cb = new fb(a);
  this.cb.add(this.g.update);
  this.cb.start();
};
function hb() {
  var a;
  a = this.canvas();
  (new gb(a.getContext("2d"), a.width, a.height)).start();
}
hb.prototype.canvas = function() {
  var a;
  a = document.createElement(navigator.Lb ? "screencanvas" : "canvas");
  a.width = window.innerWidth * window.devicePixelRatio;
  a.height = window.innerHeight * window.devicePixelRatio;
  a.style.width = "100%";
  a.style.height = "100%";
  a.style.backgroundColor = "#000000";
  document.body.appendChild(a);
  return a;
};
new hb;
